"use strict";(self["webpackChunkcms_frontend"]=self["webpackChunkcms_frontend"]||[]).push([[252],{3252(e,a,l){l.r(a),l.d(a,{default:()=>f});var t=l(641),n=l(33);const o={class:"category-manage-container"},i={class:"toolbar"};function r(e,a,l,r,d,u){const c=(0,t.g2)("el-button"),s=(0,t.g2)("el-header"),m=(0,t.g2)("el-table-column"),b=(0,t.g2)("el-table"),k=(0,t.g2)("el-input"),p=(0,t.g2)("el-form-item"),f=(0,t.g2)("el-form"),g=(0,t.g2)("el-dialog"),h=(0,t.g2)("el-main"),F=(0,t.g2)("el-container");return(0,t.uX)(),(0,t.CE)("div",o,[(0,t.bF)(F,null,{default:(0,t.k6)(()=>[(0,t.bF)(s,{class:"header"},{default:(0,t.k6)(()=>[a[6]||(a[6]=(0,t.Lk)("h1",null,"分类管理",-1)),(0,t.Lk)("div",null,[(0,t.bF)(c,{onClick:r.goToFrontend},{default:(0,t.k6)(()=>[...a[4]||(a[4]=[(0,t.eW)("返回前台",-1)])]),_:1},8,["onClick"]),(0,t.bF)(c,{type:"primary",onClick:r.goToContentManage},{default:(0,t.k6)(()=>[...a[5]||(a[5]=[(0,t.eW)("内容管理",-1)])]),_:1},8,["onClick"])])]),_:1}),(0,t.bF)(h,null,{default:(0,t.k6)(()=>[(0,t.Lk)("div",i,[(0,t.bF)(c,{type:"primary",onClick:r.handleAdd},{default:(0,t.k6)(()=>[...a[7]||(a[7]=[(0,t.eW)("新增分类",-1)])]),_:1},8,["onClick"])]),(0,t.bF)(b,{data:r.categories,border:"",stripe:""},{default:(0,t.k6)(()=>[(0,t.bF)(m,{prop:"id",label:"ID",width:"80"}),(0,t.bF)(m,{prop:"name",label:"分类名称"}),(0,t.bF)(m,{prop:"description",label:"描述"}),(0,t.bF)(m,{prop:"createTime",label:"创建时间",width:"180"},{default:(0,t.k6)(({row:e})=>[(0,t.eW)((0,n.v_)(r.formatTime(e.createTime)),1)]),_:1}),(0,t.bF)(m,{label:"操作",width:"180"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(c,{size:"small",onClick:a=>r.handleEdit(e)},{default:(0,t.k6)(()=>[...a[8]||(a[8]=[(0,t.eW)("编辑",-1)])]),_:1},8,["onClick"]),(0,t.bF)(c,{size:"small",type:"danger",onClick:a=>r.handleDelete(e)},{default:(0,t.k6)(()=>[...a[9]||(a[9]=[(0,t.eW)("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),(0,t.bF)(g,{modelValue:r.dialogVisible,"onUpdate:modelValue":a[3]||(a[3]=e=>r.dialogVisible=e),title:r.dialogTitle,width:"500px"},{footer:(0,t.k6)(()=>[(0,t.bF)(c,{onClick:a[2]||(a[2]=e=>r.dialogVisible=!1)},{default:(0,t.k6)(()=>[...a[10]||(a[10]=[(0,t.eW)("取消",-1)])]),_:1}),(0,t.bF)(c,{type:"primary",onClick:r.handleSubmit},{default:(0,t.k6)(()=>[...a[11]||(a[11]=[(0,t.eW)("确定",-1)])]),_:1},8,["onClick"])]),default:(0,t.k6)(()=>[(0,t.bF)(f,{model:r.form,"label-width":"100px"},{default:(0,t.k6)(()=>[(0,t.bF)(p,{label:"分类名称",required:""},{default:(0,t.k6)(()=>[(0,t.bF)(k,{modelValue:r.form.name,"onUpdate:modelValue":a[0]||(a[0]=e=>r.form.name=e),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),(0,t.bF)(p,{label:"描述"},{default:(0,t.k6)(()=>[(0,t.bF)(k,{modelValue:r.form.description,"onUpdate:modelValue":a[1]||(a[1]=e=>r.form.description=e),type:"textarea",rows:4,placeholder:"请输入分类描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])]),_:1})]),_:1})])}var d=l(953),u=l(1029),c=l(6155),s=l(2521),m=l(5531);const b={name:"CategoryManage",setup(){const e=(0,u.rd)(),a=(0,d.KR)([]),l=(0,d.KR)(!1),n=(0,d.KR)(""),o=(0,d.KR)({id:null,name:"",description:""}),i=async()=>{try{a.value=await(0,c.bW)()}catch(e){console.error("加载分类失败:",e)}},r=()=>{n.value="新增分类",o.value={id:null,name:"",description:""},l.value=!0},b=e=>{n.value="编辑分类",o.value={id:e.id,name:e.name,description:e.description},l.value=!0},k=async e=>{try{await s.s.confirm("确定要删除该分类吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await(0,c.K7)(e.id),m.nk.success("删除成功"),await i()}catch(a){"cancel"!==a&&m.nk.error(409===a.response?.status?"该分类下存在内容，无法删除":"删除失败")}},p=async()=>{if(o.value.name&&o.value.name.trim())try{o.value.id?(await(0,c.st)(o.value.id,o.value),m.nk.success("更新成功")):(await(0,c.zZ)(o.value),m.nk.success("创建成功")),l.value=!1,await i()}catch(e){m.nk.error("操作失败")}else m.nk.error("请输入分类名称")},f=()=>{e.push({name:"ContentManage"})},g=()=>{e.push({name:"ContentList"})},h=e=>{if(!e)return"";const a=new Date(e);return a.toLocaleString("zh-CN")};return(0,t.sV)(()=>{i()}),{categories:a,dialogVisible:l,dialogTitle:n,form:o,handleAdd:r,handleEdit:b,handleDelete:k,handleSubmit:p,goToContentManage:f,goToFrontend:g,formatTime:h}}};var k=l(6262);const p=(0,k.A)(b,[["render",r],["__scopeId","data-v-4d1224e0"]]),f=p},6155(e,a,l){l.d(a,{K7:()=>r,bW:()=>n,st:()=>i,zZ:()=>o});var t=l(5213);function n(){return(0,t.A)({url:"/categories",method:"get"})}function o(e){return(0,t.A)({url:"/categories",method:"post",data:e})}function i(e,a){return(0,t.A)({url:`/categories/${e}`,method:"put",data:a})}function r(e){return(0,t.A)({url:`/categories/${e}`,method:"delete"})}}}]);
//# sourceMappingURL=252.8f05f994.js.map