# Feature Specification: CMS 内容管理系统

**Feature Branch**: `002-cms`  
**Created**: 2026-02-27  
**Status**: Draft  
**Input**: User description: "开发一个 CMS 系统。包含后台管理端和前台展示端，聚焦核心内容管理与展示能力。前台：展示内容列表（按发布时间排序）、内容详情页（渲染 MD 格式内容）。后台：一级分类管理（增删改查）、MD 格式内容管理（增删改查、发布 / 草稿），内容需关联一级分类。核心能力：MD 文件上传 / 在线编辑，内容保存时自动渲染为 HTML，前台展示渲染后的最终内容。"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 访客浏览内容列表 (Priority: P1)

访客打开前台网站，能够查看已发布内容的列表，内容按发布时间倒序排列，最新内容显示在最前面。

**Why this priority**: 这是用户访问网站的核心入口，必须首先实现

**Independent Test**: 可通过访问内容列表页面，验证已发布内容是否按时间倒序显示

**Acceptance Scenarios**:

1. **Given** 系统存在已发布内容，**When** 访客访问内容列表页，**Then** 看到所有已发布内容按发布时间倒序排列
2. **Given** 系统无已发布内容，**When** 访客访问内容列表页，**Then** 看到空列表提示"暂无内容"
3. **Given** 内容关联了分类，**When** 访客查看内容列表，**Then** 每条内容显示其所属分类名称

---

### User Story 2 - 访客查看内容详情 (Priority: P1)

访客点击内容列表中的某条内容，进入内容详情页，查看完整的 MD 渲染后的 HTML 内容。

**Why this priority**: 内容详情是用户阅读文章的核心场景

**Independent Test**: 可通过点击内容标题，验证详情页正确渲染并显示完整内容

**Acceptance Scenarios**:

1. **Given** 访客在内容列表页，**When** 点击某条内容标题，**Then** 跳转到该内容的详情页，显示完整的 HTML 渲染内容
2. **Given** 内容包含图片和代码块，**When** 访客查看详情页，**Then** 图片正常显示，代码块有适当样式
3. **Given** 访客访问草稿状态内容，**Then** 返回 404 页面或提示内容不存在

---

### User Story 3 - 管理员管理分类 (Priority: P1)

管理员进入后台，能够创建、查看、编辑和删除一级分类。

**Why this priority**: 分类是内容组织的基础架构，必须支持完整 CRUD

**Independent Test**: 可在后台分类管理页面完成所有 CRUD 操作并验证结果

**Acceptance Scenarios**:

1. **Given** 管理员在分类管理页面，**When** 点击"新增分类"按钮，**Then** 弹出表单，填写名称后保存成功
2. **Given** 存在分类，**When** 管理员点击编辑按钮，**Then** 弹出表单，可修改分类名称并保存
3. **Given** 存在分类且无关联内容，**When** 管理员点击删除按钮，**Then** 确认后分类被删除
4. **Given** 存在分类且有关联内容，**When** 管理员点击删除按钮，**Then** 提示"该分类下存在内容，无法删除"

---

### User Story 4 - 管理员管理内容 (Priority: P1)

管理员在后台创建、编辑、删除内容，支持 MD 格式输入，支持设置发布或草稿状态，内容必须关联一个分类。

**Why this priority**: 内容管理是 CMS 的核心功能，必须支持完整 CRUD 和状态管理

**Independent Test**: 可在后台内容管理页面完成所有 CRUD 操作，包括发布/草稿状态的切换

**Acceptance Scenarios**:

1. **Given** 管理员在内容管理页面，**When** 点击"新建内容"按钮，**Then** 进入内容编辑页面，可填写标题、选择分类、输入 MD 内容
2. **Given** 管理员在内容编辑页面，**When** 选择"保存为草稿"，**Then** 内容保存为草稿状态，不在前台显示
3. **Given** 管理员在内容编辑页面，**When** 选择"发布"，**Then** 内容保存为已发布状态，显示在前台列表
4. **Given** 存在内容，**When** 管理员点击编辑，**Then** 进入编辑页面，可修改所有字段并保存
5. **Given** 存在内容，**When** 管理员点击删除，**Then** 确认后内容被删除

---

### User Story 5 - MD 内容编辑与渲染 (Priority: P1)

管理员在编辑内容时，支持在线编写 MD 或上传 MD 文件，内容保存时自动将 MD 渲染为 HTML，前台展示渲染后的最终内容。

**Why this priority**: 这是本系统的核心能力，MD 到 HTML 的自动转换是关键技术特性

**Independent Test**: 可在内容编辑时编写 MD 或上传 MD 文件，保存后在前台查看渲染效果

**Acceptance Scenarios**:

1. **Given** 管理员在内容编辑页面，**When** 在 MD 编辑器中输入内容并保存，**Then** MD 内容自动渲染为 HTML 并存储
2. **Given** 管理员在内容编辑页面，**When** 上传一个 MD 文件，**Then** 文件内容被读取并填充到编辑器中
3. **Given** 内容包含标题、列表、链接、代码块等 MD 语法，**When** 保存后在前台查看，**Then** 所有 MD 语法正确渲染为对应的 HTML 标签
4. **Given** 管理员修改已发布内容的 MD，**When** 重新发布，**Then** 前台显示更新后的 HTML 内容

---

### Edge Cases

- 访客访问不存在的 content ID 时如何处理？
- 管理员删除分类时，该分类下的内容如何处理？
- MD 内容包含恶意脚本时如何处理？
- 网络中断时，内容保存如何保证不丢失？

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 前台系统 MUST 提供内容列表页面，展示所有已发布内容
- **FR-002**: 前台内容列表 MUST 按发布时间倒序排列，最新内容优先显示
- **FR-003**: 前台系统 MUST 提供内容详情页，展示完整 HTML 渲染内容
- **FR-004**: 前台详情页 MUST 正确渲染 MD 转换后的 HTML，包括标题、段落、列表、图片、代码块等
- **FR-005**: 后台系统 MUST 提供分类管理功能，支持创建、查看、编辑、删除一级分类
- **FR-006**: 后台系统 MUST 提供内容管理功能，支持创建、查看、编辑、删除内容
- **FR-007**: 内容 MUST 关联一个一级分类，分类为必填项
- **FR-008**: 内容 MUST 支持两种状态：发布和草稿
- **FR-009**: 已发布内容 MUST显示在前台，草稿内容不显示
- **FR-010**: 后台内容编辑 MUST 支持在线 MD 编辑功能
- **FR-011**: 后台内容编辑 MUST 支持上传 MD 文件并读取内容
- **FR-012**: 内容保存时 MUST 自动将 MD 渲染为 HTML 并存储
- **FR-013**: 前台展示的内容 MUST 是渲染后的 HTML，而非原始 MD
- **FR-014**: 删除分类时，系统 MUST 检查该分类下是否有内容，如有则阻止删除

### Key Entities

- **分类 (Category)**: 代表内容的一级分类，包含名称属性，是内容的组织单位
- **内容 (Content)**: 代表具体的文章或页面，包含标题、关联分类、MD 原始内容、HTML 渲染内容、发布状态、发布时间等属性

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 访客可在 3 秒内打开内容列表页面并看到内容
- **SC-002**: 内容详情页加载时间不超过 2 秒
- **SC-003**: 管理员可在 5 分钟内完成一条内容的创建并发布
- **SC-004**: 100% 的前台访问者能够正常查看内容详情，无渲染错误
- **SC-005**: 分类的增删改查操作成功率需达到 100%
- **SC-006**: 内容的增删改查操作成功率需达到 100%
- **SC-007**: MD 文件上传成功率达到 100%，文件大小限制合理（如 5MB）
- **SC-008**: 前台内容列表按发布时间排序正确率 100%

---

## Assumptions

- 系统为单用户管理员场景，不需要复杂权限管理
- 前台和后台使用同一套数据存储
- MD 渲染使用社区通用的渲染规则（如 CommonMark 或 GitHub Flavored Markdown）
- 内容删除为物理删除，不做软删除
- 分类名称具有唯一性
- 暂时不考虑评论、标签、搜索等扩展功能